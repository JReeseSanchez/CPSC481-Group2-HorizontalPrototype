<!DOCTYPE html>
<html lang="en">
	<head>
        <link rel="stylesheet" href="css/style.css">
        <link rel="stylesheet" href="css/result.css">
        <link rel="stylesheet" href="css/search.css">
        <link rel="stylesheet" href="css/itinerary.css">
        <link rel="stylesheet" href="css/activity-popup.css">
        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">
	</head>
	<body>
        <header>
            <div id="titleHeader">
                <div id="headerLeft">
                    <a href="searchLOGIN.html"><button id="navButton">Search</button></a>
                    <a href="listItinerary.html"><button id="navButton">List Itineraries</button></a>
                </div>
                <h1 id="title"><a href="homeLOGIN.html">Travel Calgary</a></h1>
                <div id="headerRight">
                    <img id="profilePicture" src="images/defaultUser.jpg" width="75" height="75" alt="Profile ">
                    <div id="userInfo">
                        <h4>Daisy Sandwich</h4>
                        <a href="home.html"><button id="signoutButton">Sign Out</button></a>
                    </div>
                </div>
            </div>
        </header>
        <div id="mainPage">
            <div id="goBackContainer" style="display: none; margin-bottom: 20px;">
                <button id="goBackButton" onclick="goBackToItinerary()">&#8592; Go Back</button>
            </div>
            
            <div class="search-container">
                <form action="searchResult.html" method="GET">
                    <div class="search-row">
                        <input type="text" id="fname" name="fname" placeholder="Search">
                        <button class="map-view-button" onclick="showMapPopup(1)">Show Results On Map</button>                        
                    </div>
                    <div id="filters">
                        <div id="filter">
                            <label for="filterType">Type: </label>
                            <select id="filterType" name="filterType" onmouseup="showActiveFilters()">
                                <option value="activity">Activity</option>
                                <option value="food">Food</option>
                                <option value="hotel">Hotel</option>
                                <option value="park">Park</option>
                                <option value="shopping">Shopping</option>
                            </select>
                        </div>
                        
                        <div id="filter" class="distanceBox">
                            <p>Distance: <span id="distance">10</span>km</p>
                            <input type="range" id="filterDistance" min="5" max="100" step="5" value="10" onmouseup="showActiveFilters()">
    
                            <script>
                                var slider = document.getElementById("filterDistance");
                                var distance = document.getElementById("distance");
                                distance.innerHTML = slider.value;
            
                                slider.oninput = function(){
                                    distance.innerHTML = this.value;
                                }
                            </script>
                        </div>
                        <div id="filter" class="priceBox">
                            <p>Maximum Price: $<span id="price">10</span></p>
                            <input type="range" id="filterPrice" min="10" max="300" step="10" value="50" onmouseup="showActiveFilters()">
    
                            <script>
                                var sliderPrice = document.getElementById("filterPrice");
                                var price = document.getElementById("price");
                                price.innerHTML = sliderPrice.value;
            
                                sliderPrice.oninput = function(){
                                    price.innerHTML = this.value;
                                }
                            </script>
                        </div>
                        <div id="filter">
                            <label for="filterRating">Rating: </label>
                            <select id="filterRating" name="filterRating" onmouseup="showActiveFilters()">
                                <option value="1">&#9733;</option>
                                <option value="2">&#9733;&#9733;</option>
                                <option value="3">&#9733;&#9733;&#9733;</option>
                                <option value="4">&#9733;&#9733;&#9733;&#9733;</option>
                                <option value="5">&#9733;&#9733;&#9733;&#9733;&#9733;</option>
                            </select>
                        </div>
                        <input type="reset" onclick="hideActiveFilters()">
                    </div>
                </form>
                <script>
                    document.getElementById("fname").addEventListener("keypress", function(event) {
                        if (event.key === "Enter") {
                            event.preventDefault();
                            window.location.href = "searchResult.html";
                        }
                    });
                </script>
                <div id="optionButtons">
                    <button onclick="toggleFilters()" id="arrowButton">
                        <img id="filterIcon" src="images/dropdownIcon.png" width="40" height="40" alt="Toggle Filters">
                    </button>
                </div>
                <div id="activeFilter">
                    <img id="filterPhoto" src="images/activeFilter.webp" width="30" height="30" alt="Active Filters">
                    <p>Active Filter(s)</p>
                </div>
            </div>

            <div id="recommendedBox">
                <h2> Recommended Activities</h2>
                <div id="container">
                    <div id="activity">
                        <img id="activityPhoto" src="images/Little-Caesars-Logo.png" width="250" height="250" alt="Little Caesars">
                        <h3>Little Caesars</h3>
                        <div id="textRow">
                            <p>Resturant</p>
                            <p>$10-$20</p>
                        </div>
                        <div id="textRow">
                            <p>10km</p>
                            <p>4/5 &#9733;</p>
                        </div>
                        <a href="newActivity.html"><button>+ Add to Itinerary</button></a>

                    </div>
                    <div id="activity">
                        <img id="activityPhoto" src="images/OlympicOval.jpg" width="250" height="250" alt="Little Caesars">
                        <h3>Skating at the Olympic Oval</h3>
                        <div id="textRow">
                            <p>Activity</p>
                            <p>$10</p>
                        </div>
                        <div id="textRow">
                            <p>30km</p>
                            <p>4/5 &#9733;</p>
                        </div>
                        <a href="newActivity.html"><button>+ Add to Itinerary</button></a>


                    </div>
                    <div id="activity">
                        <img id="activityPhoto" src="images/Pizza73Logo.svg.png" width="250" height="250" alt="Little Caesars">
                        <h3>Little Caesars</h3>
                        <div id="textRow">
                            <p>Resturant</p>
                            <p>$10-$20</p>
                        </div>
                        <div id="textRow">
                            <p>10km</p>
                            <p>2/5 &#9733;</p>
                        </div>
                        <a href="newActivity.html"><button>+ Add to Itinerary</button></a>

                    </div>
                </div>
                <div id="container">
                    <div id="activity">
                        <img id="activityPhoto" src="images/calgaryTower.jpg" width="250" height="250" alt="Little Caesars">
                        <h3>Visit the Calgary Tower</h3>
                        <div id="textRow">
                            <p>Activity</p>
                            <p>$10-$25</p>
                        </div>
                        <div id="textRow">
                            <p>30km</p>
                            <p>4/5 &#9733;</p>
                        </div>
                        <a href="newActivity.html"><button>+ Add to Itinerary</button></a>
                    </div>
                    <div id="activity">
                        <img id="activityPhoto" src="images/mrPuffs.png" width="250" height="250" alt="Little Caesars">
                        <h3>Mr Puffs</h3>
                        <div id="textRow">
                            <p>Resturant</p>
                            <p>$15-$30</p>
                        </div>
                        <div id="textRow">
                            <p>50px</p>
                            <p>5/5 &#9733;</p>
                        </div>
                        <a href="newActivity.html"><button>+ Add to Itinerary</button></a>
                    </div>
                    <div id="activity">
                        <img id="activityPhoto" src="images/ChinookCentre.jpg" width="250" height="250" alt="Little Caesars">
                        <h3>Chinook Center Mall</h3>
                        <div id="textRow">
                            <p>Shopping</p>
                            <p>$10-$100</p>
                        </div>
                        <div id="textRow">
                            <p>20km</p>
                            <p>4/5 &#9733;</p>
                        </div>
                        <a href="newActivity.html"><button>+ Add to Itinerary</button></a>
                    </div>
                </div>
            </div>
            <div id="mapPopup" class="map-popup">
                <div class="map-popup-content">
                    <span class="close-map-popup" onclick="closeMapPopup()">&times;</span>
                    <h3 id="mapPopupTitle">Day Map View</h3>
                    <div class="map-container">
                        <img id="mapImage" src="images/1_vH7fb-tzLapLAFVOxFp7dw.png" alt="Map View" />
                    </div>
                </div>
            </div>
        </div>

        <footer>
            <div id="footer">
                <p>&copy; 2023 Travel Calgary. All rights reserved.</p>
                <a href="privacy.html">Privacy Policy</a>
                <a href="terms.html">Terms of Service</a>
            </div>

      <script>
        var filter = document.getElementById("filters");
        filter.style.display = "none";

        var activeFilter = document.getElementById("activeFilter");
        activeFilter.style.display = "none";

        function toggleFilters() {
            var filter = document.getElementById("filters");
            var icon = document.getElementById("filterIcon");
            
            if (filter.style.display === "none") {
                filter.style.display = "flex";
                // Could rotate the icon here if you want to show it's expanded
            } else {
                filter.style.display = "none";
                // Reset icon rotation
            }
        }

        function showActiveFilters(){
            activeFilter.style.display = "flex";
        }

        function hideActiveFilters(){
            activeFilter.style.display = "none";
        }

            // Check if the user came from clickonitinary.html
        if (localStorage.getItem('fromClickOnItinerary') === 'true') {
            document.getElementById('goBackContainer').style.display = 'block';
        }

        function goBackToItinerary() {
            localStorage.removeItem('fromClickOnItinerary'); // Clear the flag
            window.location.href = 'clickonitinary.html';
        }
      </script>
      <script>
        const urlParams = new URLSearchParams(window.location.search);
        const day = urlParams.get("day");
      
        document.querySelectorAll("a[href*='newActivity.html']").forEach(link => {
          if (!link.href.includes("day=")) {
            link.href += (link.href.includes("?") ? "&" : "?") + `day=${day}`;
          }
        });
      </script>
      <script>
            const mapDetails = {
        1: {
            title: 'Search results on a map',
            mapImage: 'images/1_vH7fb-tzLapLAFVOxFp7dw.png', // Replace with actual map image
        },
        // Add more days as needed
    };

    // Show the map popup
    function showMapPopup(day) {
        const popup = document.getElementById('mapPopup');
        const data = mapDetails[day] || {
            title: 'Map View',
            mapImage: 'images/1_vH7fb-tzLapLAFVOxFp7dw.png',
        };

        // Populate the popup with map details
        document.getElementById('mapPopupTitle').textContent = data.title;
        document.getElementById('mapImage').src = data.mapImage;

        // Show the popup
        popup.style.display = 'block';
    }

    // Close the map popup
    function closeMapPopup() {
        document.getElementById('mapPopup').style.display = 'none';
    }
      </script>
      
	</body>
</html>